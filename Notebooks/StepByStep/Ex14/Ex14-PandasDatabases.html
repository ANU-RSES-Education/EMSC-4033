
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercise 14 - Structured Data in Python (pandas) &#8212; EMSC 4033 Computational Geoscience</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Exercise 15 - More plotting" href="../Ex15/Ex15-MorePlotting.html" />
    <link rel="prev" title="Exercise 13 - Radioactive decay" href="../Ex13/Ex13-RadioactiveDecay.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/AuWorldEQ.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">EMSC 4033 Computational Geoscience</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../FrontPage.html">
   Computational Geosciences
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../IntroductoryRemarks.html">
   Modern approaches to programming
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  What is Python like ?
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../FirstSteps/Introduction2Python/0-CharacteristicsOfPython.html">
   What kind of Language is Python ?
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../FirstSteps/Introduction2Python/1-LePlumeDeMaTante.html">
     Python Phrase Book
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../FirstSteps/Introduction2Python/2-LiterateProgramming.html">
     Literate Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../FirstSteps/Introduction2Python/3-IntroductionToJupyterNotebooks.html">
     Jupyter Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../FirstSteps/Introduction2Python/4-IntroductionToIpython.html">
     ipython
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../FirstSteps/Introduction2Python/5-PythonDataTypes.html">
     Python data types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../FirstSteps/Introduction2Python/6-PythonClasses.html">
     Classes and objects
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Version control
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../FirstSteps/Introduction2VersionControl/1-GettingStartedWithGit.html">
   An introduction to Version Control
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python, Step by Step
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../Introduction.html">
   Exercises
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex01/Ex1-GettingStarted.html">
     Exercise 1 - Getting started with Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex02/Ex2-Variables%2Bfunctions.html">
     Exercise 2 - Variables and functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex03/Ex3-Loops%2BConditionals.html">
     Exercise 3 - Loops and conditionals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex04/Ex4-GuessingGames.html">
     Exercise 4 - Guessing Games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex05/Ex5-ListsEtc.html">
     Exercise 5 - Lists, tuples and dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex06/Ex6-MoreLoops.html">
     Exercise 6 - More loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex07/Ex7-Strings.html">
     Exercise 7 - Strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex08/Ex8-ReadWriteFiles.html">
     Exercise 8 - Reading and writing files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex09/Ex9-Modules.html">
     Exercise 9 - Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex10/Ex10-Exceptions.html">
     Exercise 10 - Exception handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex11/Ex11-numpy.html">
     Exercise 11 - NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex11/Ex11a-Sudoku.html">
     Exercise 11 - Sudoku
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex12/Ex12-Plotting.html">
     Exercise 12 - Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex13/Ex13-RadioactiveDecay.html">
     Exercise 13 - Radioactive decay
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Exercise 14 - Structured Data in Python (
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex15/Ex15-MorePlotting.html">
     Exercise 15 - More plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex16/Ex16-Maps.html">
     Exercise 16 - Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex17/Ex17-FourierAnalysis.html">
     Exercise 17 - Fourier analysis and Milankovitch cycles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex18/Ex18-Objects.html">
     Exercise 18 - Object-oriented programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex19/Ex19-DifferentialEqs.html">
     Exercise 19 - Differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Ex20/Ex20-Sorting.html">
     Exercise N - Visualising sorting algorithms
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Going deeper - examples from the Earth Sciences
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Themes/0-StartHere.html">
   Index
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../Themes/NumpyAndScipy/0-NumpyAndScipy.html">
   Numpy and Scipy
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/1-IntroductionToNumpy.html">
     Numpy data structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/2-Application-TheGameOfLife.html">
     The game of life
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/3-Discussion-TheGameOfLife.html">
     The game of life (Advanced)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/4-IntroductionToScipy.html">
     scipy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/5-ScipyInterpolate.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.interpolate
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/6-ScipySpatialAndMeshing.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.spatial
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/7-ScipyOptimize.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/NumpyAndScipy/8-Numpy%2BScipyMiscellany.html">
     Data storage
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../Themes/Mapping/0-Maps_with_Cartopy.html">
   Maps with the Cartopy Package
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/0-Preliminaries.html">
     Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/1-IntroductingCartopy.html">
     Cartopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/2-ImagesAndGeoTIFFs.html">
     Handling images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/3-WorkingWithRealData.html">
     Australian magnetic intensity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/4-ContouringGlobalData.html">
     How to use contours to view global data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/5-WorkingWithPointData.html">
     Point Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/6-WorkingWithShuttleRadarTopography.html">
     Cartopy and the Shuttle Radar Topography Map data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/7-WorkingWithOn-DemandMappingServices.html">
     On demand mapping services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/8-GlobalPlateMotionsEtc.html">
     Global Plate Motions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/9-HimalayaRegionMapsAndImages.html">
     Himalaya Maps (1)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/Mapping/9a-HimalayaRegionMapsAndImages-Pt2.html">
     Himalaya Maps (2)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../Themes/SphericalMeshing/0-Stripy.html">
   Triangulations
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/0-Spherical.html">
     Spherical Meshes
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex1-Spherical-Triangulations.html">
       Example 1 - Triangulation of arbitrary points on the sphere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex2-SphericalGrids.html">
       Example 2 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       predefined meshes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex3-Interpolation.html">
       Example 3 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       interpolation on the sphere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex4-Gradients.html">
       Example 4 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       gradients on the sphere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex5-Smoothing.html">
       Example 5 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       smoothing operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex6-Scattered-Data.html">
       Example 6 - Scattered Data and ‘Heat Maps’
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex7-Refinement-of-Triangulations.html">
       Example 7 - Refining a triangulation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex8-Spline-Tension.html">
       Example 8 - Spline Tension
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/SphericalTriangulations/Ex9-Voronoi-Diagram.html">
       Example 9 - Constructing the Voronoi diagram
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/0-Cartesian.html">
     Cartesian Meshes
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex1-Cartesian-Triangulations.html">
       Example 1 - Triangulation of arbitrary points
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex2-CartesianGrids.html">
       Example 2 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       predefined meshes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex3-Interpolation.html">
       Example 3 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       interpolation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex4-Gradients.html">
       Example 4 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       gradients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex5-Smoothing.html">
       Example 5 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       smoothing operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex6-Scattered-Data.html">
       Example 6 - Scattered Data and ‘Heat Maps’
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex7-Refinement-of-Triangulations.html">
       Example 7 - Refining a triangulation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex8-Spline-Tension.html">
       Example 8 - Spline Tension
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/CartesianTriangulations/Ex9-Voronoi-Diagram.html">
       Example 9 - Constructing the Voronoi diagram
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/Ex1-Litho1Layers.html">
     Introduction to the stripy wrapper for litho 1.0
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/Ex2-Litho1Properties.html">
       Litho 1.0 global sampling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/Ex3-CrustalRegionalisation.html">
       Crust 1.0 data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WorkEx1-CratonAverageProperties.html">
       Properties of the cratons
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WorkEx2-OceanDepthAge.html">
       Age of the oceans / depth of the oceans
      </a>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-1.html">
       A quick look at the depth-age relationship for the seafloor.
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-2.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-3.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-4.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../Themes/SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-5.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../Themes/SympleSympy/StartingWithSympy.html">
   Getting started with
   <code class="docutils literal notranslate">
    <span class="pre">
     sympy
    </span>
   </code>
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/SympleSympy/StartingWithSympy-2.html">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
     for ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/SympleSympy/StartingWithSympy-3.html">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
     for a PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/SympleSympy/StartingWithSympy-4.html">
     The biharmonic equation for Stokes flow
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../Themes/SolveMathProblems/0-IntroductionToNumericalSolutions.html">
   Numerical models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/SolveMathProblems/1-GroundwaterFlow-LectureNotes.html">
     Partial Differential Equations of Groundwater Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/SolveMathProblems/2-FiniteDifferences.html">
     Finite difference operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Themes/SolveMathProblems/3-AdvancedFiniteDifferences.html">
     Advanced finite difference
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/Notebooks/StepByStep/Ex14/Ex14-PandasDatabases.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ANU-RSES-Education/EMSC-4033"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ANU-RSES-Education/EMSC-4033/master?urlpath=tree/Notebooks/StepByStep/Ex14/Ex14-PandasDatabases.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://emsc4033-2021.rses.underworldcloud.org/hub/user-redirect/git-pull?repo=https://github.com/ANU-RSES-Education/EMSC-4033&urlpath=tree/EMSC-4033/Notebooks/StepByStep/Ex14/Ex14-PandasDatabases.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-basics">
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
   basics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-should-labels-be">
     What should labels be?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-write-data">
     Read &amp; Write Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microsoft-excel">
     Microsoft Excel
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reading-from-the-web">
     Reading from the Web(!)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-data-cleaning">
   Plotting &amp; Data Cleaning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#subsets">
   Subsets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reset-index">
   reset_index()
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-dataframes">
   Merge Dataframes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operations-and-new-columns">
   Operations and New Columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selecting-data">
   Selecting Data
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="exercise-14-structured-data-in-python-pandas">
<h1>Exercise 14 - Structured Data in Python (<a class="reference external" href="https://pandas.pydata.org/"><code class="docutils literal notranslate"><span class="pre">pandas</span></code></a>)<a class="headerlink" href="#exercise-14-structured-data-in-python-pandas" title="Permalink to this headline">¶</a></h1>
<p>You should now know how to open files, read data tables from them using numpy, and write your outputs to new files.  Getting data in/out of Python is a routine task for data analysis, and people have put a lot of effort into making it as simple as possible. <a class="reference external" href="https://pandas.pydata.org/"><code class="docutils literal notranslate"><span class="pre">pandas</span></code></a> is one of the main data science modules, which specialises in handling ‘spreadsheet’-type data - i.e. a data table with column and/or row labels.</p>
<p>In this practical you’ll learn the basics of reading and writing data using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, some basic data manipulation and plotting.</p>
<p>In addition to this practical, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> has a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/tutorials.html">number of excellent tutorials</a> focussed at beginners. There is also a chapter about <code class="docutils literal notranslate"><span class="pre">pandas</span></code> in the <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.00-introduction-to-pandas.html">Python Data Science Handbook</a>. If your work is based around spreadsheet-type data, we strongly recommend going through these tutorials in due course.</p>
<div class="section" id="pandas-basics">
<h2><code class="docutils literal notranslate"><span class="pre">pandas</span></code> basics<a class="headerlink" href="#pandas-basics" title="Permalink to this headline">¶</a></h2>
<p>The central concept of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. This is a 2D table of data, with associated row and column labels - just like a spreadsheet. A <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be ‘indexed’ by row or column names - i.e. you use the row/column <em>labels</em>, instead of their numeric indices like you do in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> started as a convenient way to import and export labeled data, but has grown into something a lot more comprehensive, and now does basic statistics, plotting, time-series analysis, ‘split-apply-combine’ data grouping… and much more.</p>
<p>You import pandas just like any other module; conventionally, we use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p>To create a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, you need some 2D data, which you give to <code class="docutils literal notranslate"><span class="pre">pandas</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>➤ Generate a numpy array of random data with 3 rows and 4 columns, and make a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>744</td>
      <td>464</td>
      <td>264</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>425</td>
      <td>689</td>
      <td>965</td>
      <td>858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>998</td>
      <td>396</td>
      <td>909</td>
      <td>873</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When you look at the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, it should look like a nice table in the Jupyter notbook, with numbered rows and columns. These numbers are the same as the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> indices that you could use to access these rows/column.</p>
<p>You can access these data by these indices, just like you would in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. However, because <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> are quite a lot more complex than <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays, you can’t index them directly -  you have to use <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>.</p>
<p><strong>➤ Use the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> method to index your <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Compare it to <code class="docutils literal notranslate"><span class="pre">numpy</span></code> indexing.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># first number is row, second number is column - just like numpy!</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    998
1    396
2    909
3    873
Name: 2, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>So far, everything we’ve done can be achieved with equivalent convenience in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>… so what’s the point? The strength of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is in its use of data labels, so you can associate rows/columns with meaningful information, rather than numerical indices.</p>
<p>This can be really useful if, for example, you’re working with a dataset that you add new columns to over time. If you were using numpy, the numeric indices of the columns of interest might change, and break your code. With <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, your code will be fine as long as the labels of the columns stays the same.</p>
<p>Let’s assign some labels to your dataset. You can do this by setting the <code class="docutils literal notranslate"><span class="pre">columns</span></code> or <code class="docutils literal notranslate"><span class="pre">index</span></code> (rows) attributes of your dataframe with a list of strings whose length is equal to the number of columns or rows. For example,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Label_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Label_2&#39;</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="s1">&#39;Label_N&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Row_1&#39;</span><span class="p">,</span><span class="s1">&#39;Row_2&#39;</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="s1">&#39;Row_M&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="what-should-labels-be">
<h3>What should labels be?<a class="headerlink" href="#what-should-labels-be" title="Permalink to this headline">¶</a></h3>
<p>You can call columns/rows whatever you like. A column name could be a whole paragraph, if you really wanted… but this is a really bad idea. You should use labels that are <strong>unique</strong>, <strong>meaningful</strong> and <strong>concise</strong>.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">Temperature</span></code> isn’t great - what are the units? What if you have Kelvin, Centigrade <em>and</em> Fahrenheit columns? <code class="docutils literal notranslate"><span class="pre">Temperature</span> <span class="pre">°C</span></code> is better, but will be cumbersome in routine use, because it’s long, and has special characters and spaces in. <code class="docutils literal notranslate"><span class="pre">T_C</span></code> is ideal - it’s nice and short, containing a commonly used abbreviation for temperature (‘T’), and the unit.</p>
<p><strong>Bonus:</strong> If your label names start with a letter and don’t contain spaces or special characters, you can access them directly using the <code class="docutils literal notranslate"><span class="pre">.</span></code> operator, without needing to use <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Label_1</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Label_1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>both produce return the same column, but <code class="docutils literal notranslate"><span class="pre">df.Label_1</span></code> brings the added benefit of having <kbd>Tab</kbd> auto-completion for your column names! This can be really convenient if, for example, you want to access columns during plotting.</p>
<p><strong>➤ Label the columns of your dataframe as [A, B, C, D], and your rows [X, Y, Z]:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>

<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>X</th>
      <td>744</td>
      <td>464</td>
      <td>264</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Y</th>
      <td>425</td>
      <td>689</td>
      <td>965</td>
      <td>858</td>
    </tr>
    <tr>
      <th>Z</th>
      <td>998</td>
      <td>396</td>
      <td>909</td>
      <td>873</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When you look at your dataframe again, you should see that it now displays the column/row names that you gave it.</p>
<p><strong>➤ Access column ‘B’ of your data:</strong></p>
<p><strong>Hint:</strong> If you want to select a particular column, you’ll have to use the <code class="docutils literal notranslate"><span class="pre">:</span></code> operator to specify ‘all row values’, just like in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X    744
Y    425
Z    998
Name: A, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>You may also notice here that numeric indices no longer work with the <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> operator. You <em>can</em> still use numeric indices if you <em>really</em> want to using <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code>… although if you’re doing this all the time you’d be better off using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> instead of pandas.</p>
<p>Just like <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays, <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> also contain a number of useful properties, such as <code class="docutils literal notranslate"><span class="pre">.size</span></code> and <code class="docutils literal notranslate"><span class="pre">.shape</span></code>, which tell you useful information about the data.</p>
<p><strong>➤ Try it here:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>

<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 4)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-write-data">
<h3>Read &amp; Write Data<a class="headerlink" href="#read-write-data" title="Permalink to this headline">¶</a></h3>
<p>Pandas has a number of functions for reading and writing data in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/io.html">wide range of formats</a>.</p>
<p>Data reading functions are available within the pandas module in the form <code class="docutils literal notranslate"><span class="pre">pd.read_FORMAT()</span></code>, and return a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Writing functions are available as a method directly accessible from the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, and are in the form <code class="docutils literal notranslate"><span class="pre">dataframe.to_FORMAT()</span></code>. In both these cases, replace <code class="docutils literal notranslate"><span class="pre">FORMAT</span></code> with the desired data format (e.g. ‘excel’ or ‘csv’). Both of these functions take a file path and a number of other arguments that modify their behaviour.</p>
<p><strong>➤ Load the file ‘boston.csv’ into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, find out how large the dataset is, and look at the top 5 rows.</strong></p>
<p><strong>Hint 1:</strong> Take a look at the file in a text editor first, and then use pandas’ <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> function. You’ll probably want to use the <code class="docutils literal notranslate"><span class="pre">comment</span></code> parameter to tell pandas that lines beginning with <code class="docutils literal notranslate"><span class="pre">#</span></code> are comments and should be ignored!</p>
<p><strong>Hint 2:</strong> Try the <code class="docutils literal notranslate"><span class="pre">.shape</span></code> attribute.</p>
<p><strong>Hint 3:</strong> Use the <code class="docutils literal notranslate"><span class="pre">.head()</span></code> method to see the top N lines (and <code class="docutils literal notranslate"><span class="pre">.tail()</span></code> to see the bottom N!)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>

<span class="n">boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;boston.csv&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
<span class="n">boston</span><span class="o">.</span><span class="n">shape</span>
<span class="n">boston</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0.0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1.0</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>➤ Save the Boston <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as an html table</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boston</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="s1">&#39;boston.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Take a look at the resulting files, to make sure they look right. Have a play around with parameters (e.g. <code class="docutils literal notranslate"><span class="pre">index=False</span></code> to remove the row numbers).</p>
</div>
<div class="section" id="microsoft-excel">
<h3>Microsoft Excel<a class="headerlink" href="#microsoft-excel" title="Permalink to this headline">¶</a></h3>
<p>Is irritatingly common in science. Irritating, because it saves data in a proprietary binary format which can’t be easily read without having a copy of Microsoft Excel (or sometimes, the right <em>version</em> of Microsoft Excel!). There are ways of importing Excel files into Python, but most are quite complex. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> offers a very easy solution to this problem.</p>
<p><strong>➤ Load the file <code class="docutils literal notranslate"><span class="pre">iris.xlsx</span></code> into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, with <code class="docutils literal notranslate"><span class="pre">species</span></code> as the index (row) labels</strong></p>
<p><strong>Hint 1:</strong> the data are in a sheet called ‘iris_data’.</p>
<p><strong>Hint 2:</strong> Everything is installed on the RSES Jupyter server, but you will need to install the package <code class="docutils literal notranslate"><span class="pre">xlrd</span></code> to read Excel spreedsheets with Pandas on your computer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;iris.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;iris_data&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
    </tr>
    <tr>
      <th>species</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>setosa</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>setosa</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>setosa</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>setosa</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>setosa</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>➤ Save the iris <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as a csv</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;iris.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>➤ Save the iris <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as a <span class="math notranslate nohighlight">\(\LaTeX\)</span> table</strong></p>
<p>This can be <em>really</em> useful if you do your work in <span class="math notranslate nohighlight">\(\LaTeX\)</span>, as you might for a MSc or PhD thesis!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="s1">&#39;iris.tex&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reading-from-the-web">
<h3>Reading from the Web(!)<a class="headerlink" href="#reading-from-the-web" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> can also read data directly from the web, which is useful if you’re using a central database which is regularly updated.</p>
<p>For example, the famous <a class="reference external" href="https://www.esrl.noaa.gov/gmd/ccgg/trends/full.html">Mauna Loa Atmospheric CO2 Dataset</a>, which is updated monthly.</p>
<p>The URL for the monthly dataset is: <span class="xref myst">ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt</span></p>
<p><strong>➤ Look at this dataset in your browser, and read it into a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> using the <code class="docutils literal notranslate"><span class="pre">pd.read_table</span></code> function.</strong></p>
<p><strong>Hint 1:</strong> you’ll need to specify the delimiter between the data columns using the <code class="docutils literal notranslate"><span class="pre">delimiter</span></code> argument.</p>
<p><strong>Hint 2:</strong> because of data formatting choices, there’s no simple way to get the column headings from this dataset, and you’ll have to assign them manually.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">co2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;decimal_year&#39;</span><span class="p">,</span> <span class="s1">&#39;co2_average&#39;</span><span class="p">,</span> <span class="s1">&#39;co2_interpolated&#39;</span><span class="p">,</span> <span class="s1">&#39;co2_trend&#39;</span><span class="p">,</span> <span class="s1">&#39;n_days&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>decimal_year</th>
      <th>co2_average</th>
      <th>co2_interpolated</th>
      <th>co2_trend</th>
      <th>n_days</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1958</td>
      <td>3</td>
      <td>1958.208</td>
      <td>315.71</td>
      <td>315.71</td>
      <td>314.62</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1958</td>
      <td>4</td>
      <td>1958.292</td>
      <td>317.45</td>
      <td>317.45</td>
      <td>315.29</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1958</td>
      <td>5</td>
      <td>1958.375</td>
      <td>317.50</td>
      <td>317.50</td>
      <td>314.71</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1958</td>
      <td>6</td>
      <td>1958.458</td>
      <td>-99.99</td>
      <td>317.10</td>
      <td>314.85</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1958</td>
      <td>7</td>
      <td>1958.542</td>
      <td>315.86</td>
      <td>315.86</td>
      <td>314.98</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="plotting-data-cleaning">
<h2>Plotting &amp; Data Cleaning<a class="headerlink" href="#plotting-data-cleaning" title="Permalink to this headline">¶</a></h2>
<p>Let’s have a look at this CO2 record. Combine what you learned about indexing DataFrames and plotting to make a line graph of time (decimal year) vs. average CO2.</p>
<p><strong>➤ Make a plot!</strong> You can simply pass the dataframe columns to <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> as if they were Numpy arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Try it here!</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2</span><span class="o">.</span><span class="n">decimal_year</span><span class="p">,</span> <span class="n">co2</span><span class="o">.</span><span class="n">co2_average</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x10cdcd470&gt;]
</pre></div>
</div>
<img alt="../../../_images/Ex14-PandasDatabases_26_1.png" src="../../../_images/Ex14-PandasDatabases_26_1.png" />
</div>
</div>
<p>This looks mad! There are several points where average CO2 is less than zero… what’s going on?</p>
<p>You’ll see from the header of the Mauna Load CO2 record that values that are equal the -99.99 represent ‘missing data’. We therefore want to exclude this data from further analyses.</p>
<p><strong>➤ Do this by using the <code class="docutils literal notranslate"><span class="pre">.replace()</span></code> method to substitute <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> for <code class="docutils literal notranslate"><span class="pre">-99.99</span></code>, then re-draw the plot</strong></p>
<p><strong>Hint:</strong> you want to replace these values in the original dataset, rather than return a copy of the data with these values replaced. Think about what the <code class="docutils literal notranslate"><span class="pre">inplace</span></code> argument does in this function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=-</span><span class="mf">99.99</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2</span><span class="o">.</span><span class="n">decimal_year</span><span class="p">,</span> <span class="n">co2</span><span class="o">.</span><span class="n">co2_average</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x10e2e4978&gt;]
</pre></div>
</div>
<img alt="../../../_images/Ex14-PandasDatabases_29_1.png" src="../../../_images/Ex14-PandasDatabases_29_1.png" />
</div>
</div>
<p>Much better! Let’s keep a copy of this data for future offline use.</p>
<p><strong>➤ Save the co2 data as a csv file.</strong></p>
<p>You’ll notice this data has an overall trend, and a period oscillation around the trend. This oscillation is caused by seasonal changes in the balance between respiration and photosynthesis - CO2 drops in the summer, when plants in the Northern hemisphere are photosynthesising more.</p>
<p>Let’s try to isolate the overall trend by working out a yearly, instead of monthly trend.</p>
<p>We can do this using the ‘split-apply-combine’ methodology. We ‘split’ the data according to the value of a particular field, ‘apply’ a function to each subset, and the ‘combine’ all the results back together.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">pandas</span></code> we do this using the <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> function to specify that all records with the same entry for a particular field should be treated as a group, followed by <code class="docutils literal notranslate"><span class="pre">aggregate</span></code> (or <code class="docutils literal notranslate"><span class="pre">apply</span></code>, for more complex operations) to specify how each group should be reduced into a single number.</p>
<p><strong>➤ Calculate and plot the annual mean CO2 for the Mauna Loa record</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_annual</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2</span><span class="o">.</span><span class="n">decimal_year</span><span class="p">,</span> <span class="n">co2</span><span class="o">.</span><span class="n">co2_average</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2_annual</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">co2_annual</span><span class="o">.</span><span class="n">co2_average</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f2d96145c50&gt;]
</pre></div>
</div>
<img alt="../../../_images/Ex14-PandasDatabases_34_1.png" src="../../../_images/Ex14-PandasDatabases_34_1.png" />
</div>
</div>
</div>
<div class="section" id="subsets">
<h2>Subsets<a class="headerlink" href="#subsets" title="Permalink to this headline">¶</a></h2>
<p>Often, you might want to create a subset of a dataset. For example, you might wish to isolate only the <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">co2_average</span></code> information from the yearly mean.</p>
<p>You can do this by indexing the dataset, and assigning it to a new name.</p>
<p><strong>➤ Create a subset of the annual mean data containing only the <code class="docutils literal notranslate"><span class="pre">co2_average</span></code> column</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_ann</span> <span class="o">=</span> <span class="n">co2_annual</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;co2_average&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reset-index">
<h2>reset_index()<a class="headerlink" href="#reset-index" title="Permalink to this headline">¶</a></h2>
<p>In this subset you’ll notice that you only have one column, but the ‘year’ information is preserved in the <code class="docutils literal notranslate"><span class="pre">index</span></code> of the data. You can turn the index back into a data column using <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code>.</p>
<p><strong>➤ Try it here!</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_ann</span> <span class="o">=</span> <span class="n">co2_ann</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="merge-dataframes">
<h2>Merge Dataframes<a class="headerlink" href="#merge-dataframes" title="Permalink to this headline">¶</a></h2>
<p>Let’s try to look at the seasonal oscillation in more detail. To do this, we need to subtract the annual mean. However, at the moment our annual mean and our seasonal data are in two different <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> of different sizes.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> has a number of functions for combining and merging <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> in different ways. Let’s have a go at using <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> to combine the annual mean dataset with the original data.</p>
<p><strong>➤ Try it here!</strong> You will need to look at the help for <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> to work out how to do this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_comb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">co2</span><span class="p">,</span> <span class="n">co2_ann</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_ann&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="operations-and-new-columns">
<h2>Operations and New Columns<a class="headerlink" href="#operations-and-new-columns" title="Permalink to this headline">¶</a></h2>
<p>Now we’ve combined them, we need to subtract the annual mean from the monthly signal to isolate the seasonal trend.</p>
<p><strong>➤ Create a new column containing the seasonal signal</strong></p>
<p><strong>Hint:</strong> If you try to assign something to an index that doesn’t exist, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> creates a new column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_comb</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;seasonal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">co2_comb</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;co2_average&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">co2_comb</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;co2_average_ann&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">co2_comb</span><span class="o">.</span><span class="n">decimal_year</span><span class="p">,</span> <span class="n">co2_comb</span><span class="o">.</span><span class="n">seasonal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f2d960825c0&gt;]
</pre></div>
</div>
<img alt="../../../_images/Ex14-PandasDatabases_43_1.png" src="../../../_images/Ex14-PandasDatabases_43_1.png" />
</div>
</div>
</div>
<div class="section" id="selecting-data">
<h2>Selecting Data<a class="headerlink" href="#selecting-data" title="Permalink to this headline">¶</a></h2>
<p>Remember indexing from above? You can use a similar approach in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to select data in a number of ways. For example, we can use ‘logical indexing’ to select data only from the last 10 years.</p>
<p>To do this, we use logical operators (<code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>) to create a <code class="docutils literal notranslate"><span class="pre">boolean</span></code> array the same size as a dimension of our array. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2008</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">ind</span></code> will be <code class="docutils literal notranslate"><span class="pre">True</span></code> wherever year is greater than or equal to 2008.</p>
<p>We can then apply this to select a subset of our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">last_ten</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
<p><strong>➤ Create a subset containing the years between 1980-1990, and plot the seasonal trend.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decade</span> <span class="o">=</span> <span class="n">co2_comb</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">co2_comb</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">1980</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">co2_comb</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">1990</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decade</span><span class="o">.</span><span class="n">decimal_year</span><span class="p">,</span> <span class="n">decade</span><span class="o">.</span><span class="n">seasonal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f2d96066588&gt;]
</pre></div>
</div>
<img alt="../../../_images/Ex14-PandasDatabases_46_1.png" src="../../../_images/Ex14-PandasDatabases_46_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Notebooks/StepByStep/Ex14"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../Ex13/Ex13-RadioactiveDecay.html" title="previous page">Exercise 13 - Radioactive decay</a>
    <a class='right-next' id="next-link" href="../Ex15/Ex15-MorePlotting.html" title="next page">Exercise 15 - More plotting</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Louis Moresi<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>