
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Himalaya Maps (2) &#8212; EMSC 4033 Computing in Geoscience</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Triangulations" href="../SphericalMeshing/0-Stripy.html" />
    <link rel="prev" title="Himalaya Maps (1)" href="9-HimalayaRegionMapsAndImages.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/AuWorldEQ.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">EMSC 4033 Computing in Geoscience</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../FrontPage.html">
   Jupyterbook example
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Modern Approaches to Programming
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../Introduction2Python/1-IntroductionToJupyterNotebooks.html">
   Jupyter Notebooks
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../Introduction2Python/2-IntroductionToIpython.html">
     ipython
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Introduction2Python/3-PythonDataTypes.html">
     Python data types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Introduction2Python/4-PythonClasses.html">
     Classes and objects
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../Introduction2VersionControl/1-GettingStartedWithGit.html">
   An introduction to Version Control
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../Introduction2VersionControl/2-NextStepsWithGit.html">
     An introduction to Version Control pt 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Introduction2VersionControl/3-YourOwnRepositories.html">
     How to use git for yourself
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Plotting/1-IntroductionToMatplotlib.html">
   Introduction to matplotlib
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Step by Step
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../StepByStep/Introduction.html">
   Andrew Valentine’s Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex01/Exercise%201%20-%20Getting%20started.html">
     Exercise 1 - Getting started with Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex02/Exercise%202%20-%20Variables%20and%20functions.html">
     Exercise 2 - Variables and functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex02/Exercise%202%20-%20Variables%20and%20functions.html#functions">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex03/Exercise%203%20-%20Loops%20and%20conditionals.html">
     Exercise 3 - Loops and conditionals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex04/Guessing%20Games.html">
     Exercise 4 - Guessing Games
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex05/Exercise%205%20-%20Lists%2C%20tuples%20and%20dictionaries.html">
     Exercise 5 - Lists, tuples and dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex06/Exercise%206%20-%20More%20loops.html">
     Exercise 6 - More loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex07/Exercise%207%20-%20Strings.html">
     Exercise 7 - Strings
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex08/Exercise%208%20-%20Reading%20and%20writing%20files.html">
     Exercise 8 - Reading and writing files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex09/Exercise%209%20-%20Modules.html">
     Exercise 9 - Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex10/Exercise%2010%20-%20Exception%20handling.html">
     Exercise 10 - Exception handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex11/Exercise%2011%20-%20Sudoku.html">
     Exercise 11 - Sudoku
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex12/Exercise%2012%20-%20Plotting.html">
     Exercise 12 - Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex13/Exercise%2013%20-%20Radioactive%20Decay.html">
     Exercise 13 - Radioactive decay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex14/Exercise%2014%20-%20Pandas.html">
     Exercise 14 - Structured Data in Python (
     <code class="docutils literal notranslate">
      <span class="pre">
       pandas
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex15/Exercise%2015%20-%20More%20plotting.html">
     Exercise 15 - More plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex16/Exercise%2016%20-%20Maps.html">
     Exercise 16 - Maps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex17/Exercise%2017%20-%20Fourier%20analysis%20and%20Milankovitch%20cycles.html">
     Exercise 17 - Fourier analysis and Milankovitch cycles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex18/Exercise%2018%20-%20Object-oriented%20programming.html">
     Exercise N - Object-oriented programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex19/Exercise%20N%20-%20differential%20equations.html">
     Exercise N - Differential equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../StepByStep/Ex20/Exercise%20N%20-%20Sorting.html">
     Exercise N - Visualising sorting algorithms
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Going deeper - examples from the Earth Sciences
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../NumpyAndScipy/0-NumpyAndScipy.html">
   Numpy and Scipy
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/1-IntroductionToNumpy.html">
     Numpy data structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/2-Application-TheGameOfLife.html">
     The game of life
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/3-Discussion-TheGameOfLife.html">
     The game of life (Advanced)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/3-Discussion-TheGameOfLife.html#animation">
     Animation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/4-IntroductionToScipy.html">
     scipy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/5-ScipyInterpolate.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.interpolate
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/6-ScipySpatialAndMeshing.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.spatial
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/7-ScipyOptimize.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../NumpyAndScipy/8-Numpy%2BScipyMiscellany.html">
     Data storage
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="0-Maps_with_Cartopy.html">
   Maps with the Cartopy Package
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="0-Preliminaries.html">
     Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1-IntroductingCartopy.html">
     Cartopy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2-ImagesAndGeoTIFFs.html">
     Handling images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3-WorkingWithRealData.html">
     Australian magnetic intensity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4-ContouringGlobalData.html">
     How to use contours to view global data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5-WorkingWithPointData.html">
     Point Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6-WorkingWithShuttleRadarTopography.html">
     Cartopy and the Shuttle Radar Topography Map data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="7-WorkingWithOn-DemandMappingServices.html">
     On demand mapping services
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="8-GlobalPlateMotionsEtc.html">
     Global Plate Motions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="9-HimalayaRegionMapsAndImages.html">
     Himalaya Maps (1)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Himalaya Maps (2)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../SphericalMeshing/0-Stripy.html">
   Triangulations
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/0-Spherical.html">
     Spherical Meshes
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex1-Spherical-Triangulations.html">
       Example 1 - Triangulation of arbitrary points on the sphere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex2-SphericalGrids.html">
       Example 2 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       predefined meshes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex3-Interpolation.html">
       Example 3 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       interpolation on the sphere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex4-Gradients.html">
       Example 4 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       gradients on the sphere
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex5-Smoothing.html">
       Example 5 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       smoothing operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex6-Scattered-Data.html">
       Example 6 - Scattered Data and ‘Heat Maps’
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex7-Refinement-of-Triangulations.html">
       Example 7 - Refining a triangulation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex8-Spline-Tension.html">
       Example 8 - Spline Tension
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/SphericalTriangulations/Ex9-Voronoi-Diagram.html">
       Example 9 - Constructing the Voronoi diagram
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/0-Cartesian.html">
     Cartesian Meshes
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex1-Cartesian-Triangulations.html">
       Example 1 - Triangulation of arbitrary points
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex2-CartesianGrids.html">
       Example 2 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       predefined meshes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex3-Interpolation.html">
       Example 3 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       interpolation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex4-Gradients.html">
       Example 4 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       gradients
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex5-Smoothing.html">
       Example 5 -
       <code class="docutils literal notranslate">
        <span class="pre">
         stripy
        </span>
       </code>
       smoothing operations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex6-Scattered-Data.html">
       Example 6 - Scattered Data and ‘Heat Maps’
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex7-Refinement-of-Triangulations.html">
       Example 7 - Refining a triangulation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex8-Spline-Tension.html">
       Example 8 - Spline Tension
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/CartesianTriangulations/Ex9-Voronoi-Diagram.html">
       Example 9 - Constructing the Voronoi diagram
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../SphericalMeshing/Litho1pt0/Ex1-Litho1Layers.html">
     Introduction to the stripy wrapper for litho 1.0
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/Litho1pt0/Ex2-Litho1Properties.html">
       Litho 1.0 global sampling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/Litho1pt0/Ex3-CrustalRegionalisation.html">
       Crust 1.0 data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WorkEx1-CratonAverageProperties.html">
       Properties of the cratons
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WorkEx2-OceanDepthAge.html">
       Age of the oceans / depth of the oceans
      </a>
     </li>
     <li class="toctree-l3 collapsible-parent">
      <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-1.html">
       A quick look at the depth-age relationship for the seafloor.
      </a>
      <ul class="collapse-ul">
       <li class="toctree-l4">
        <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-2.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-3.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-4.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../SphericalMeshing/Litho1pt0/WEx2-Tutorial/Notebook-5.html">
         A quick look at the depth-age relationship for the seafloor.
        </a>
       </li>
      </ul>
      <i class="fas fa-chevron-down">
      </i>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../SympleSympy/StartingWithSympy.html">
   Getting started with
   <code class="docutils literal notranslate">
    <span class="pre">
     sympy
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../SympleSympy/StartingWithSympy.html#differentiation-integration">
   Differentiation / Integration
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../SympleSympy/StartingWithSympy-2.html">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
     for ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SympleSympy/StartingWithSympy-2.html#use-of-the-sympy-equation-module-eq">
     Use of the
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
     equation module (
     <code class="docutils literal notranslate">
      <span class="pre">
       Eq
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SympleSympy/StartingWithSympy-3.html">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       sympy
      </span>
     </code>
     for a PDE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SympleSympy/StartingWithSympy-4.html">
     The biharmonic equation for Stokes flow
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../SolveMathProblems/0-IntroductionToNumericalSolutions.html">
   Numerical models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../SolveMathProblems/1-GroundwaterFlow-LectureNotes.html">
     Partial Differential Equations of Groundwater Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SolveMathProblems/2-FiniteDifferences.html">
     Finite difference operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SolveMathProblems/3-AdvancedFiniteDifferences.html">
     Advanced finite difference
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../../_sources/Notebooks/Themes/Mapping/9a-HimalayaRegionMapsAndImages-Pt2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/Notebooks/Themes/Mapping/9a-HimalayaRegionMapsAndImages-Pt2.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ANU-RSES-Education/EMSC-4033"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ANU-RSES-Education/EMSC-4033/master?urlpath=tree/Notebooks/Themes/Mapping/9a-HimalayaRegionMapsAndImages-Pt2.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://emsc4033-2021.rses.underworldcloud.org/hub/user-redirect/git-pull?repo=https://github.com/ANU-RSES-Education/EMSC-4033&urlpath=tree/EMSC-4033/Notebooks/Themes/Mapping/9a-HimalayaRegionMapsAndImages-Pt2.md&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="himalaya-maps-2">
<h1>Himalaya Maps (2)<a class="headerlink" href="#himalaya-maps-2" title="Permalink to this headline">¶</a></h1>
<p>Figures 2a, 2b and 3 from my SIAM News publication in 2015: <a class="reference external" href="http://www.moresi.info/posts/Computational-Challenges-SIAM-NEWS/">http://www.moresi.info/posts/Computational-Challenges-SIAM-NEWS/</a></p>
<p>Caption, Figure 2 - <em>One of the most dramatic departures from plate-like deformation on Earth occurs where the Indian subcontinent is colliding with the Eurasian continent. The map on the left is a satellite image with the flow lines from the plate motion vector field drawn in red. On the right is the same region showing 50 years of earthquake data for events larger than magnitude 4.5, colored by depth and superimposed on the strain rate.</em></p>
<p>Caption, Figure 3 - <em>A low-angle view of a numerical model of continental collision using the Underworld particle-in-cell finite element code. <strong>The map (1) shows the how to interpret the model in terms of the India-Eurasia collision.</strong> In the movie, the (Indian) indentor heads towards the viewer and crumples the crust into a mountain belt in the foreground. In the background, the crust escapes away from the viewer pulled by the subduction zone in the background. Snapshots from the movie: (2), pre-collision and (3), late in the collision.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline


<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal_array</span>


<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">cartopy.io</span> <span class="kn">import</span> <span class="n">PostprocessedRasterSource</span><span class="p">,</span> <span class="n">LocatedImage</span>
<span class="kn">from</span> <span class="nn">cartopy.io</span> <span class="kn">import</span> <span class="n">srtm</span>
<span class="kn">from</span> <span class="nn">cartopy.io.srtm</span> <span class="kn">import</span> <span class="n">SRTM3Source</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>

<span class="kn">import</span> <span class="nn">scipy.ndimage</span>
<span class="kn">import</span> <span class="nn">scipy.misc</span>

<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">netcdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The colormap routine creates enormous arrays in intermediary calculations. This is</span>
<span class="c1"># a way to avoid memory errors: process to RGB (int8) in advance</span>

<span class="k">def</span> <span class="nf">apply_colormap_to_image</span><span class="p">(</span><span class="n">rawimage</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>

    <span class="n">greyimage</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">rawimage</span><span class="p">)</span>
    <span class="n">rgbimage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">greyimage</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">greyimage</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">greyimage</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">rgbimage</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">greyimage</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span> <span class="o">*</span> <span class="mi">256</span>
                
    <span class="n">rgbimage2</span> <span class="o">=</span> <span class="n">rgbimage</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>        
    
    <span class="k">return</span> <span class="n">rgbimage2</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_projection</span>     <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span> 
<span class="n">global_extent</span>     <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">180.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">]</span>

<span class="n">etopo1</span>       <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;Resources/color_etopo1_ice_low.tif&quot;</span><span class="p">)</span>
<span class="n">etopo_img</span>    <span class="o">=</span> <span class="n">etopo1</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">etopo1</span><span class="p">)</span>

<span class="c1"># Height field only ... </span>
<span class="n">etopoH</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;Resources/ETOPO1_Ice_c_geotiff.tif&quot;</span><span class="p">)</span> 
<span class="n">etopoH_img</span> <span class="o">=</span> <span class="n">etopoH</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()[::</span><span class="mi">2</span><span class="p">,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">etopoH</span><span class="p">)</span>

<span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">5000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7500</span><span class="p">)</span>
<span class="n">etopoH_img_grey</span> <span class="o">=</span> <span class="n">apply_colormap_to_image</span><span class="p">(</span><span class="n">etopoH_img</span><span class="p">,</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>

<span class="n">strainrate_extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">68</span><span class="p">,</span><span class="mi">80</span><span class="p">]</span>
<span class="n">strainrate</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;Resources/sec_invariant_strain_0.2.dat&quot;</span><span class="p">)</span>
<span class="n">strainrate_data</span> <span class="o">=</span> <span class="n">strainrate</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">741</span><span class="p">,</span><span class="mi">1800</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># I had to look at the data to work this out !</span>

<span class="n">globalrelief</span>      <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;Resources/HYP_50M_SR_W/HYP_50M_SR_W.tif&quot;</span><span class="p">)</span>
<span class="n">globalrelief_img</span>  <span class="o">=</span> <span class="n">globalrelief</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">globalrelief</span><span class="p">)</span>

<span class="n">globalbathym</span>      <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;Resources/OB_50M/OB_50M.tif&quot;</span><span class="p">)</span>
<span class="n">globalbathym_img</span>  <span class="o">=</span> <span class="n">globalbathym</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">globalbathym</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;etopoH_img - &quot;</span><span class="p">,</span> <span class="n">etopoH_img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;globalrelief_img - &quot;</span><span class="p">,</span> <span class="n">globalrelief_img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">## If the shapes are different then see the cell below for a way to fix it.</span>

<span class="n">blended_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">globalrelief_img</span><span class="p">)</span>
<span class="n">blended_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">etopoH_img</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">globalbathym_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">globalrelief_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="n">blended_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">etopoH_img</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">globalbathym_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">globalrelief_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="n">blended_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">etopoH_img</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">globalbathym_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">globalrelief_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># Clean up ... we&#39;ll just keep the int8 rgb versions for plotting</span>

<span class="k">del</span><span class="p">(</span><span class="n">globalbathym_img</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">globalrelief_img</span><span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">etopoH_img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">6</span><span class="n">f3e747e0af5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">etopo1</span>       <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;Resources/color_etopo1_ice_low.tif&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">etopo_img</span>    <span class="o">=</span> <span class="n">etopo1</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="k">del</span><span class="p">(</span><span class="n">etopo1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> 

<span class="ne">AttributeError</span>: &#39;NoneType&#39; object has no attribute &#39;ReadAsArray&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do this if the relief / bathym sizes don&#39;t match the etopo data (to make the blended image)</span>
<span class="c1"># The datasets we downloaded can be manipulated trivially without the need for this and I have</span>
<span class="c1"># commented it all out so you can run all cells without reprocessing the data files. </span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">import scipy.ndimage</span>
<span class="sd">import scipy.misc</span>


<span class="sd">etopoH = gdal.Open(&quot;Resources/ETOPO1_Ice_g_geotiff.tif&quot;)</span>
<span class="sd">etopoH_img = etopoH.ReadAsArray()</span>

<span class="sd">print </span>

<span class="sd">etopoH_transform = etopoH.GetGeoTransform()</span>
<span class="sd">globalrelief_transform = globalrelief.GetGeoTransform()</span>

<span class="sd"># Resize to match globalrelief ... this resize is int only ??</span>

<span class="sd">globaletopoH = scipy.misc.imresize(etopoH_img, globalrelief_img.shape, mode=&#39;F&#39;)</span>

<span class="sd">## How to turn this array back into the appropriate geotiff</span>

<span class="sd">from osgeo import gdal</span>
<span class="sd">from osgeo import osr</span>

<span class="sd"># data exists in &#39;ary&#39; with values range 0 - 255</span>
<span class="sd"># Uncomment the next line if ary[0][0] is upper-left corner</span>
<span class="sd">#ary = numpy.flipup(ary)</span>

<span class="sd">Ny, Nx = globaletopoH.shape</span>
<span class="sd">driver = gdal.GetDriverByName(&quot;GTiff&quot;)</span>
<span class="sd"># Final argument is optional but will produce much smaller output file</span>
<span class="sd">ds = driver.Create(&#39;output.tif&#39;, Nx, Ny, 1, gdal.GDT_Float64, [&#39;COMPRESS=LZW&#39;])</span>

<span class="sd"># this assumes the projection is Geographic lat/lon WGS 84</span>
<span class="sd">srs = osr.SpatialReference()</span>
<span class="sd">srs.ImportFromEPSG(4326)</span>
<span class="sd">ds.SetProjection(srs.ExportToWkt())</span>

<span class="sd">ds.SetGeoTransform( globalrelief_transform  ) # define GeoTransform tuple</span>
<span class="sd">ds.GetRasterBand(1).WriteArray(globaletopoH)</span>
<span class="sd">ds = None</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># img_heights  = etopo_img.reshape(-1)</span>

<span class="n">base_projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">global_extent</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span> <span class="p">]</span>

<span class="n">coastline</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;coastline&#39;</span><span class="p">,</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                           <span class="n">edgecolor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span>
                           <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

<span class="n">rivers</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;rivers_lake_centerlines&#39;</span><span class="p">,</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                                        <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;Blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

<span class="n">lakes</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;lakes&#39;</span><span class="p">,</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                                        <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">ocean</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;ocean&#39;</span><span class="p">,</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                           <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                           <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">graticules_5</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;graticules_5&#39;</span><span class="p">,</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span>
                           <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.core</span> <span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span> <span class="nn">obspy.clients.fdsn</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">UTCDateTime</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s2">&quot;IRIS&quot;</span><span class="p">)</span>

<span class="n">himalaya_extent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">45</span> <span class="p">]</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;1971-01-01&quot;</span><span class="p">)</span>
<span class="n">endtime</span>   <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2021-01-01&quot;</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_events</span><span class="p">(</span><span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span>
                        <span class="n">minlongitude</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">maxlongitude</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">minlatitude</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">maxlatitude</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">minmagnitude</span><span class="o">=</span><span class="mf">5.5</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;ISC&quot;</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="s2">&quot; events in catalogue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>858  events in catalogue
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unpack the opspy data into a plottable array</span>

<span class="n">event_count</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="n">eq_origins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">event_count</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ev</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">events</span><span class="p">):</span>
    <span class="n">eq_origins</span><span class="p">[</span><span class="n">ev</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span>
    <span class="n">eq_origins</span><span class="p">[</span><span class="n">ev</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span>
    <span class="n">eq_origins</span><span class="p">[</span><span class="n">ev</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;depth&#39;</span><span class="p">]</span>
    <span class="n">eq_origins</span><span class="p">[</span><span class="n">ev</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">magnitudes</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
    <span class="n">eq_origins</span><span class="p">[</span><span class="n">ev</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">origins</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">year</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rootgrp</span> <span class="o">=</span> <span class="n">netcdf</span><span class="o">.</span><span class="n">netcdf_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;Resources/velocity_EU.nc&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ve</span> <span class="o">=</span> <span class="n">rootgrp</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;ve&quot;</span><span class="p">]</span>
<span class="n">vn</span> <span class="o">=</span> <span class="n">rootgrp</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;vn&quot;</span><span class="p">]</span>

<span class="n">lonv</span> <span class="o">=</span> <span class="n">rootgrp</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span>
<span class="n">latv</span> <span class="o">=</span> <span class="n">rootgrp</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span>

<span class="n">lons</span> <span class="o">=</span> <span class="n">lonv</span><span class="p">[::</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">latv</span><span class="p">[::</span><span class="mi">1</span><span class="p">]</span>
<span class="n">llX</span><span class="p">,</span> <span class="n">llY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span>

<span class="c1">#llX = llX.reshape(-1)</span>
<span class="c1">#llY = llY.reshape(-1)</span>

<span class="n">Veast</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ve</span><span class="p">[::</span><span class="mi">1</span><span class="p">,::</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">Vnorth</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vn</span><span class="p">[::</span><span class="mi">1</span><span class="p">,::</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">Vorientation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Vnorth</span><span class="p">,</span><span class="n">Veast</span><span class="p">)</span>
<span class="n">Vspeed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Veast</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Vnorth</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="mi">11421</span><span class="n">d59577c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">rootgrp</span> <span class="o">=</span> <span class="n">netcdf</span><span class="o">.</span><span class="n">netcdf_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;Resources/velocity_EU.nc&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">ve</span> <span class="o">=</span> <span class="n">rootgrp</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;ve&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">rootgrp</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;vn&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 

<span class="nn">/usr/share/miniconda3/envs/jupyter/lib/python3.7/site-packages/scipy/io/netcdf.py</span> in <span class="ni">__init__</span><span class="nt">(self, filename, mode, mmap, version, maskandscale)</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span>             <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>             <span class="n">omode</span> <span class="o">=</span> <span class="s1">&#39;r+&#39;</span> <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span> <span class="k">else</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">249</span>             <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">b&#39;</span> <span class="o">%</span> <span class="n">omode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>             <span class="k">if</span> <span class="n">mmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>                 <span class="c1"># Mmapped files on PyPy cannot be usually closed</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;Resources/velocity_EU.nc&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Figure 2a is a land / ocean image with coastlines and rivers over the top.</span>
<span class="c1">## The red / grey lines are streamlines of the plate motion data which show trajectories in </span>
<span class="c1">## a way which is not as intrusive as a bunch of arrows.</span>

<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">offset_copy</span>

<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.io.img_tiles</span> <span class="k">as</span> <span class="nn">cimgt</span>

<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>


<span class="c1"># Map / Image Tile machinery</span>


<span class="n">mapbox_satellite</span> <span class="o">=</span> <span class="n">cimgt</span><span class="o">.</span><span class="n">MapboxTiles</span><span class="p">(</span><span class="n">map_id</span><span class="o">=</span><span class="s1">&#39;satellite&#39;</span><span class="p">,</span> 
                                     <span class="n">access_token</span><span class="o">=</span><span class="s1">&#39;pk.eyJ1IjoibG91aXNtb3Jlc2kiLCJhIjoiY2pzeG1mZzFqMG5sZDQ0czF5YzY1NmZ4cSJ9.lpsUzmLasydBlS0IOqe5JA&#39;</span><span class="p">)</span>


<span class="n">mapbox_streets</span> <span class="o">=</span> <span class="n">cimgt</span><span class="o">.</span><span class="n">MapboxTiles</span><span class="p">(</span><span class="n">map_id</span><span class="o">=</span><span class="s1">&#39;streets&#39;</span><span class="p">,</span> 
                                     <span class="n">access_token</span><span class="o">=</span><span class="s1">&#39;pk.eyJ1IjoibG91aXNtb3Jlc2kiLCJhIjoiY2pzeG1mZzFqMG5sZDQ0czF5YzY1NmZ4cSJ9.lpsUzmLasydBlS0IOqe5JA&#39;</span><span class="p">)</span>


<span class="c1">## Google maps image tiles ()</span>
<span class="n">google_maps_street</span> <span class="o">=</span> <span class="n">cimgt</span><span class="o">.</span><span class="n">GoogleTiles</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;street&quot;</span><span class="p">)</span> 
<span class="n">google_maps_satellite</span> <span class="o">=</span> <span class="n">cimgt</span><span class="o">.</span><span class="n">GoogleTiles</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span> 
<span class="n">google_maps_terrain</span> <span class="o">=</span> <span class="n">cimgt</span><span class="o">.</span><span class="n">GoogleTiles</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">)</span> 

<span class="c1"># Choose one of the services above. I used map_tiles = mapbox_satellite for the published </span>
<span class="c1"># plot, but this does require registration here: https://www.mapbox.com/help/create-api-access-token/</span>
<span class="c1"># The map_quest image does not seem to be registered correctly with the coastline so I am probably doing something</span>
<span class="c1"># wrong. But the mapbox one looks perfectly fine !</span>

<span class="n">map_tiles</span> <span class="o">=</span> <span class="n">mapbox_satellite</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="c1"># ax = plt.axes(projection=ccrs.PlateCarree(), extent=himalaya_extent)</span>

<span class="c1"># Create a GeoAxes in the tile&#39;s projection.</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">map_tiles</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>

    <span class="c1"># Limit the extent of the map to a small longitude/latitude range.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">himalaya_extent</span><span class="p">)</span>

    <span class="c1"># Add the MapQuest data at zoom level 8.</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">Veast</span><span class="p">,</span> <span class="n">Vnorth</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
              <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gray_r</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">map_tiles</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">streamlines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">Veast</span><span class="p">,</span> <span class="n">Vnorth</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">Vspeed</span><span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#883300&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds_r</span><span class="p">,</span>
              <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">streamlines</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">coastline</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>  <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;White&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span>    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;#0077FF&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span>    <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;#002299&quot;</span><span class="p">,</span>    <span class="n">zorder</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">lakes</span><span class="p">,</span>     <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#4477FF&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#222222&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span> <span class="p">)</span>

<span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># gl.xlines = False</span>
<span class="c1"># gl.xlines = False</span>


<span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">glyxlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mi">881</span><span class="n">cb02b4a84</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span>     <span class="c1"># Add the MapQuest data at zoom level 8.</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> 
<span class="ne">---&gt; </span><span class="mi">49</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">Veast</span><span class="p">,</span> <span class="n">Vnorth</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">50</span>               <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">gray_r</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> 

<span class="ne">NameError</span>: name &#39;lons&#39; is not defined
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda3/envs/jupyter/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:388: MatplotlibDeprecationWarning: 
The &#39;inframe&#39; parameter of draw() was deprecated in Matplotlib 3.3 and will be removed two minor releases later. Use Axes.redraw_in_frame() instead. If any parameter follows &#39;inframe&#39;, they should be passed as keyword, not positionally.
  inframe=inframe)
</pre></div>
</div>
<img alt="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_11_2.png" src="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_11_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;HimalayaRivers.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## This is figure 2b ... greyscale topography and bathymetry with strain rate contours and </span>
<span class="c1">## earthquake hypocentres plotted on top</span>


<span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extent</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">etopoH_img_grey</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> 
           <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">global_extent</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;spline16&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mappable2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> 
         <span class="n">levels</span><span class="o">=</span><span class="p">[</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span> <span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span> <span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
         <span class="n">transform</span><span class="o">=</span><span class="n">base_projection</span><span class="p">,</span>  <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">OrRd_r</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
         <span class="n">extent</span><span class="o">=</span><span class="n">strainrate_extent</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>


<span class="c1"># plt.colorbar(mappable=mappable2)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">coastline</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>  <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># ax.add_feature(rivers,    linewidth=1,    edgecolor=&quot;Blue&quot;, zorder=12)</span>
<span class="c1"># ax.add_feature(lakes,     linewidth=1,    edgecolor=&quot;Blue&quot;, zorder=13, alpha=0.25)</span>
<span class="c1"># ax.add_feature(graticules_5,     linewidth=0.5, linestyle=&quot;:&quot;,    edgecolor=&quot;gray&quot;, zorder=4, alpha=0.75)</span>


<span class="c1"># ax.add_feature(ocean, facecolor=(0.4,0.4,0.6), edgecolor=(0.0,0.0,0.0), linewidth=1, alpha=0.75, zorder=4)</span>

<span class="n">depth_scale</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">eq_origins</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">eq_origins</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">50.0</span><span class="o">*</span><span class="p">(</span><span class="n">eq_origins</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mf">4.5</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">eq_origins</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
               <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues_r</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">35000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>


<span class="c1"># plt.colorbar(mappable=depth_scale)</span>


<span class="c1">## Labels</span>

<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#222222&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span> <span class="p">)</span>

<span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabels_left</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># gl.xlines = False</span>
<span class="c1"># gl.xlines = False</span>


<span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">65</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">glyxlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>


<span class="c1">## Legendary stuff </span>
<span class="c1">#  For the published figure, I used these circles to give me the scale and colour</span>
<span class="c1"># but made my own legend in a drawing program</span>

<span class="c1"># mag4_color     = cm.Blues( 1.0 )</span>
<span class="c1"># mag4_dot35km   = ax.scatter(66.0, 6.0, 50.0*(4.6-4.5), marker=&#39;o&#39;, color=mag4_color,</span>
<span class="c1">#                  vmin=30000, vmax=100000, alpha = 0.85, linewidth=0.5, zorder=21)</span>

<span class="n">mag5_color</span>     <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span> <span class="mf">1.0</span><span class="o">-</span> <span class="p">(</span><span class="mi">50</span> <span class="o">-</span> <span class="mi">30</span><span class="p">)</span> <span class="o">/</span> <span class="mi">70</span> <span class="p">)</span>
<span class="n">mag5_dot50km</span>   <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">66.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="o">*</span><span class="p">(</span><span class="mf">6.0</span><span class="o">-</span><span class="mf">5.5</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mag5_color</span><span class="p">,</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="n">mag6_color</span>     <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span> <span class="p">(</span><span class="mi">70</span> <span class="o">-</span> <span class="mi">30</span><span class="p">)</span> <span class="o">/</span> <span class="mi">70</span> <span class="p">)</span>
<span class="n">mag6_dot70km</span>   <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">66.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="o">*</span><span class="p">(</span><span class="mf">6.5</span><span class="o">-</span><span class="mf">5.5</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mag6_color</span><span class="p">,</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="n">mag7_color</span>     <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">(</span> <span class="mf">0.0</span> <span class="p">)</span>
<span class="n">mag7_dot100km</span>   <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">66.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="o">*</span><span class="p">(</span><span class="mf">7.5</span><span class="o">-</span><span class="mf">5.5</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mag7_color</span><span class="p">,</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="n">f1e81c16e781</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extent</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> 
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">etopoH_img_grey</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">14</span>            <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">global_extent</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;spline16&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> 

<span class="ne">NameError</span>: name &#39;etopoH_img_grey&#39; is not defined
</pre></div>
</div>
<img alt="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_13_1.png" src="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;HimalayaEQ.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Figure 3a is the regional setting which is used as a base to draw an</span>
<span class="c1">## interpretation of some 3D models. </span>

<span class="n">himalaya_region_extent</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">55</span> <span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">45</span> <span class="p">]</span>

<span class="n">map_tiles</span> <span class="o">=</span> <span class="n">mapbox_satellite</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="c1"># ax = plt.axes(projection=ccrs.PlateCarree(), extent=himalaya_extent)</span>

<span class="c1"># Create a GeoAxes in the tile&#39;s projection.</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">map_tiles</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>

<span class="c1"># Limit the extent of the map</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">himalaya_region_extent</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">map_tiles</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">coastline</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>  <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;cartopy.mpl.feature_artist.FeatureArtist at 0x7ff539835e10&gt;
</pre></div>
</div>
<img alt="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_15_1.png" src="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;HimalayaRegionalMap.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## An alternative to Figure 2a !</span>


<span class="n">theCM</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Oranges&#39;</span><span class="p">)</span>
<span class="n">theCM</span><span class="o">.</span><span class="n">_init</span><span class="p">()</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">theCM</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>
<span class="n">theCM</span><span class="o">.</span><span class="n">_lut</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">alphas</span><span class="o">**</span><span class="mf">0.25</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extent</span><span class="o">=</span><span class="n">himalaya_extent</span><span class="p">)</span>
<span class="c1"># plt.imshow(strainrate_img, cmap=theCM, origin=&quot;lower&quot;, interpolation=&quot;spline16&quot;, extent=strainrate_extent, </span>
<span class="c1">#             vmin=-1, vmax=100)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">etopo_img</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> 
         <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
         <span class="n">transform</span><span class="o">=</span><span class="n">base_projection</span><span class="p">,</span>  <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">strainrate_extent</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> 
         <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
         <span class="n">transform</span><span class="o">=</span><span class="n">base_projection</span><span class="p">,</span>  <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">strainrate_extent</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">coastline</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>  <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">lakes</span><span class="p">,</span>     <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">15</span><span class="o">-</span><span class="mi">8</span><span class="n">a0e5919faa6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="c1">#             vmin=-1, vmax=100)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> 
<span class="ne">---&gt; </span><span class="mi">15</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">etopo_img</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> 
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">strainrate_data</span><span class="p">[:,:,</span><span class="mi">2</span><span class="p">],</span> 

<span class="ne">NameError</span>: name &#39;etopo_img&#39; is not defined
</pre></div>
</div>
<img alt="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_17_1.png" src="../../../_images/9a-HimalayaRegionMapsAndImages-Pt2_17_1.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Notebooks/Themes/Mapping"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="9-HimalayaRegionMapsAndImages.html" title="previous page">Himalaya Maps (1)</a>
    <a class='right-next' id="next-link" href="../SphericalMeshing/0-Stripy.html" title="next page">Triangulations</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Louis Moresi<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>